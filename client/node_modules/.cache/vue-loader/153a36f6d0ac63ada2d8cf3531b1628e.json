{"remainingRequest":"/home/minht/Projects/vue/mevn-blog/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/minht/Projects/vue/mevn-blog/client/src/pages/Write.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/minht/Projects/vue/mevn-blog/client/src/pages/Write.vue","mtime":1637936415824},{"path":"/home/minht/Projects/vue/mevn-blog/client/node_modules/cache-loader/dist/cjs.js","mtime":1635854546509},{"path":"/home/minht/Projects/vue/mevn-blog/client/node_modules/babel-loader/lib/index.js","mtime":1635854546514},{"path":"/home/minht/Projects/vue/mevn-blog/client/node_modules/cache-loader/dist/cjs.js","mtime":1635854546509},{"path":"/home/minht/Projects/vue/mevn-blog/client/node_modules/vue-loader/lib/index.js","mtime":1635854563590}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IEJsb2dTZXJ2aWNlIGZyb20gIi4uL3NlcnZpY2VzL0Jsb2dTZXJ2aWNlIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiV3JpdGUiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VybmFtZTogIiIsCiAgICAgIHRpdGxlOiAiIiwKICAgICAgZGVzYzogIiIsCiAgICAgIGZpbGU6ICIiLAogICAgICBwb3N0X3Bob3RvOiAiIiwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyhbInVzZXIiXSksCiAgfSwKICBtZXRob2RzOiB7CiAgICBvbkZpbGVTZWxlY3RlZChldmVudCkgewogICAgICB0aGlzLmZpbGUgPSBldmVudC50YXJnZXQuZmlsZXNbMF07CiAgICAgIGNvbnNvbGUubG9nKGV2ZW50LnRhcmdldC5maWxlc1swXSk7CiAgICAgIGNvbnN0IGRhdGEgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGV2ZW50LnRhcmdldC5maWxlc1swXSk7CiAgICAgIHRoaXMucG9zdF9waG90byA9IGRhdGE7CiAgICB9LAogICAgaGFuZGxlU3VibWl0KCkgewogICAgICBsZXQgbmV3UG9zdCA9IHt9OwogICAgICBpZiAodGhpcy51c2VyLnVzZXJuYW1lKSB7CiAgICAgICAgbmV3UG9zdCA9IHsKICAgICAgICAgIHVzZXJuYW1lOiB0aGlzLnVzZXIudXNlcm5hbWUsCiAgICAgICAgICB0aXRsZTogdGhpcy50aXRsZSwKICAgICAgICAgIGRlc2M6IHRoaXMuZGVzYywKICAgICAgICB9OwogICAgICB9CgogICAgICBpZiAodGhpcy5maWxlKSB7CiAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICAgIGNvbnN0IGZpbGVuYW1lID0gRGF0ZS5ub3coKSArIHRoaXMuZmlsZS5uYW1lOwoKICAgICAgICBkYXRhLmFwcGVuZCgibmFtZSIsIGZpbGVuYW1lKTsKICAgICAgICBkYXRhLmFwcGVuZCgiZmlsZSIsIHRoaXMuZmlsZSk7CiAgICAgICAgbmV3UG9zdC5waG90byA9IGZpbGVuYW1lOwoKICAgICAgICBCbG9nU2VydmljZS5wb3N0RmlsZShkYXRhKQogICAgICAgICAgLnRoZW4oKCkgPT4gewogICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJUaGVyZSB3YXMgYW4gZXJyb3I6IiArIGVycm9yLnJlcyk7CiAgICAgICAgICB9KTsKICAgICAgfQogICAgICBCbG9nU2VydmljZS5uZXdQb3N0KG5ld1Bvc3QpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9wb3N0LyIgKyByZXMuZGF0YS5faWQpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgYWxlcnQoIkNhbid0IGFkZCBwb3N0Iik7CiAgICAgICAgICBjb25zb2xlLmxvZygiVGhlcmUgd2FzIGFuIGVycm9yOiIgKyBlcnJvci5yZXMpOwogICAgICAgIH0pOwogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Write.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Write.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div v-if=\"user\" class=\"write\">\n    <img v-if=\"file\" class=\"write-img\" :src=\"post_photo\" alt=\"\" />\n    <form class=\"write-form\" @submit.prevent=\"handleSubmit\">\n      <div class=\"write-form-group\">\n        <label for=\"fileInput\">\n          <i class=\"write-icon fas fa-plus\"></i>\n        </label>\n        <input\n          id=\"fileInput\"\n          type=\"file\"\n          style=\"display: none\"\n          @change=\"onFileSelected\"\n        />\n        <input\n          class=\"write-input\"\n          placeholder=\"Title\"\n          type=\"text\"\n          autoFocus=\"true\"\n          v-model=\"title\"\n        />\n      </div>\n      <div class=\"write-form-group\">\n        <textarea\n          class=\"write-input write-text\"\n          placeholder=\"Tell your story...\"\n          type=\"text\"\n          autoFocus=\"true\"\n          v-model=\"desc\"\n        />\n      </div>\n      <button class=\"write-submit\" type=\"submit\">Publish</button>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from \"vuex\";\nimport BlogService from \"../services/BlogService\";\n\nexport default {\n  name: \"Write\",\n  data() {\n    return {\n      username: \"\",\n      title: \"\",\n      desc: \"\",\n      file: \"\",\n      post_photo: \"\",\n    };\n  },\n  computed: {\n    ...mapGetters([\"user\"]),\n  },\n  methods: {\n    onFileSelected(event) {\n      this.file = event.target.files[0];\n      console.log(event.target.files[0]);\n      const data = URL.createObjectURL(event.target.files[0]);\n      this.post_photo = data;\n    },\n    handleSubmit() {\n      let newPost = {};\n      if (this.user.username) {\n        newPost = {\n          username: this.user.username,\n          title: this.title,\n          desc: this.desc,\n        };\n      }\n\n      if (this.file) {\n        const data = new FormData();\n        const filename = Date.now() + this.file.name;\n\n        data.append(\"name\", filename);\n        data.append(\"file\", this.file);\n        newPost.photo = filename;\n\n        BlogService.postFile(data)\n          .then(() => {\n            console.log(data);\n          })\n          .catch((error) => {\n            console.log(\"There was an error:\" + error.res);\n          });\n      }\n      BlogService.newPost(newPost)\n        .then((res) => {\n          this.$router.push(\"/post/\" + res.data._id);\n        })\n        .catch((error) => {\n          alert(\"Can't add post\");\n          console.log(\"There was an error:\" + error.res);\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.write {\n  padding-top: 50px;\n}\n\n.write-img {\n  margin-left: 150px;\n  width: 70vw;\n  height: 250px;\n  border-radius: 10px;\n  object-fit: cover;\n}\n\n.write-form {\n  position: relative;\n}\n\n.write-form-group {\n  margin-left: 150px;\n  display: flex;\n  align-items: center;\n}\n\n.write-icon {\n  width: 25px;\n  height: 25px;\n  font-size: 20px;\n  border: 1px solid;\n  border-radius: 50%;\n  color: rgb(129, 125, 125);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n}\n\n.write-input {\n  font-size: 30px;\n  border: none;\n  padding: 20px;\n  width: 70vw;\n}\n\n.write-input::placeholder {\n  color: rgb(189, 185, 185);\n  font-weight: 400;\n}\n\n.write-input:focus {\n  outline-style: none;\n}\n\n.write-text {\n  width: 70vw;\n  height: 100vh;\n  font-family: inherit;\n  font-size: 20px;\n}\n\n.write-submit {\n  position: absolute;\n  top: 20px;\n  right: 50px;\n  color: white;\n  background-color: teal;\n  padding: 10px;\n  border: none;\n  border-radius: 10px;\n  font-size: 16px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n}\n</style>"]}]}